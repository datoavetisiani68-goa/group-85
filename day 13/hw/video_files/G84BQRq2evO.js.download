;/*FB_PKG_DELIM*/

__d("LSOptimisticUpdateThreadDisappearingSetting",["LSIssueNewError","LSIssueNewTask","LSLocalize"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(e){return t.sortBy(t.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(e,t){var n=e.done,o=e.value;return n?r[0]=!1:(t=o.item,r[0]=t.errorShouldBeShown)})},function(e){return r[0]===!0?t.sequence([function(e){return n("LSLocalize").localizeV2Async(t.i64.cast([0,2285622730]),void 0).then(function(e){return r[4]=e})},function(e){return n("LSLocalize").localizeV2Async(t.i64.cast([0,1919524925]),void 0).then(function(e){return r[5]=e})},function(e){return t.storedProcedure(n("LSIssueNewError"),void 0,t.i64.cast([0,1545093]),r[4],r[5],void 0,void 0)}]):t.resolve()},function(o){return r[2]=new t.Map,r[2].set("wa_jid",void 0),r[2].set("thread_key",e[0]),r[2].set("disappearing_ttl",e[1]),r[2].set("updated_timestamp",e[2]),r[2].set("updated_by",e[3]),r[2].set("sync_group",t.i64.cast([0,95])),r[2].set("ephemerality_type",void 0),r[3]=t.toJSON(r[2]),t.storedProcedure(n("LSIssueNewTask"),"disappearing_setting",t.i64.cast([0,714]),r[3],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxOptimisticUpdateThreadDisappearingSettingStoredProcedure",e.__tables__=["user_visible_network_connectivity_error"],a.exports=e}),null);
__d("LSOptimisticUpdateThreadDisappearingSettingStoredProcedure",["LSOptimisticUpdateThreadDisappearingSetting","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){a===void 0&&(a={});var i=t.storedProcedure(r("LSOptimisticUpdateThreadDisappearingSetting"),a.threadKey,a.disappearingTtl,a.updatedTimestamp,a.updatedBy);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LsMessageClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1743853"),s=o("FalcoLoggerInternal").create("ls_message_click",e),u=s;l.default=u}),98);
__d("MAWEphemeralSettingsUpdate",["FBLogger","I64","LSOptimisticUpdateThreadDisappearingSettingStoredProcedure","MAWChatJid","MAWCurrentUser","MAWEphemeralMsgAutoResetSystemId","gkx","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("MAWEphemeralSettingsUpdate"),u=r("requireDeferred")("LSFactory").__setRef("MAWEphemeralSettingsUpdate"),c=r("requireDeferred")("WATimeUtils").__setRef("MAWEphemeralSettingsUpdate");async function d(t,n,r,a){var i=await t.threads.get(a);if(i!=null){var l=i.disappearingSettingUpdatedTs,s=i.disappearingSettingTtl;if(l==null||s==null||(e||(e=o("I64"))).lt(l,(e||(e=o("I64"))).of_float(r))&&!(e||(e=o("I64"))).equal(s,(e||(e=o("I64"))).of_int32(n)))return!0}return!1}async function m(t,n,a,i,l,s,c){var m=await d(t,n,a,l);if(!m)return Promise.resolve();s&&r("FBLogger")("wmi_eb").addMetadata("LABYRINTH_WEB","APP_VERSION","OCCAM_EPHEMERAL_SETTINGS_UPDATE").info("[Occam][Web] Ephemeral Settings Updated.");var p=await u.load();return r("LSOptimisticUpdateThreadDisappearingSettingStoredProcedure")(p(t),{disappearingTtl:(e||(e=o("I64"))).of_int32(n),threadKey:l,updatedBy:e.of_string(i?r("MAWEphemeralMsgAutoResetSystemId"):c!=null?c:o("MAWCurrentUser").getID()),updatedTimestamp:e.of_float(a)})}async function p(e,t,n,r){var o=await s.load(),a=await o();return a.runInTransaction(function(o){return m(o,e,t,n,r,!1)},"readwrite")}async function _(e,t,n,a,i){var l=await s.load(),u=await l(),d;return r("gkx")("11440")&&(d=(await c.load()).castUnixTimeToMillisTime(t)),u.runInTransaction(async function(l){var s=await o("MAWChatJid").toThreadKeyMaybe(l,a);return s!=null?m(l,e,r("gkx")("11440")?d:(await c.load()).castUnixTimeToMillisTime(t),n,s,i):Promise.resolve()},"readwrite")}l.updateEphemeralSettingsWithTxn=m,l.updateEphemeralSettings=p,l.updateEphemeralSettingsByChatJid=_}),98);
__d("MWPReplyLogging",["I64","QPLUserFlow","deepEquals","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new Map;function u(t){var n=Date.now()|0;return s.set((e||(e=o("I64"))).to_string(t),n),n}function c(t){var n=s.get((e||(e=o("I64"))).to_string(t));return n==null?u(t):n}function d(t,n,a){if(a){t?r("QPLUserFlow").endCancel(r("qpl")._(25298086,"3996"),{instanceKey:c(n)}):r("QPLUserFlow").endSuccess(r("qpl")._(25298086,"3996"),{instanceKey:c(n)}),s.delete((e||(e=o("I64"))).to_string(n));return}}function m(e,t,n){if(e!=null){if(r("deepEquals")(e,t)){r("QPLUserFlow").addPoint(r("qpl")._(25298086,"3996"),"same_message",{instanceKey:c(n)});return}if(!r("deepEquals")(e,t)){var o=c(n);r("QPLUserFlow").addPoint(r("qpl")._(25298086,"3996"),"switch_message",{instanceKey:o}),r("QPLUserFlow").endCancel(r("qpl")._(25298086,"3996"),{instanceKey:o}),r("QPLUserFlow").start(r("qpl")._(25298086,"3996"),{cancelOnUnload:!0,instanceKey:u(n),timeoutInMs:6e4});return}}r("QPLUserFlow").start(r("qpl")._(25298086,"3996"),{cancelOnUnload:!0,instanceKey:u(n),timeoutInMs:6e4})}var p={logClearReply:d,logSetReply:m};l.default=p}),98);
__d("MwbCmInformTreatmentEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("6736"),s=o("FalcoLoggerInternal").create("mwb_cm_inform_treatment_event",e),u=s;l.default=u}),98);
__d("MwbInformTreatmentShownImpressionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("6735"),s=o("FalcoLoggerInternal").create("mwb_inform_treatment_shown_impression",e),u=s;l.default=u}),98);
__d("RtcWebUserActionsDebugFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1744337"),s=o("FalcoLoggerInternal").create("rtc_web_user_actions_debug",e),u=s;l.default=u}),98);
__d("RtcWebUserActionsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1744338"),s=o("FalcoLoggerInternal").create("rtc_web_user_actions",e),u=s;l.default=u}),98);
__d("SoundPlayer",["ODS","URI","createArrayFromMixed"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=new Map;function c(e){var t=new(s||(s=r("URI")))(e);return t.getDomain()?e:new(s||(s=r("URI")))(window.location.href).setPath(t.getPath()).toString()}function d(e){var t=new(s||(s=r("URI")))(e).getPath();return/\.mp3$/.test(t)?"audio/mpeg":/\.og[ga]$/.test(t)?"audio/ogg":""}var m=function(t,n){for(var e of r("createArrayFromMixed")(t)){if(u.has(e))return;var o=document.createElement("audio");if(!(!o||!o.canPlayType||!o.canPlayType(d(e)))){o.preload="auto",o.src=c(e),document.body&&document.body.appendChild(o),u.set(e,o),(n==null?void 0:n.onPreload)!=null&&n.onPreload(o);return}}},p=function(n,a){a===void 0&&(a={});for(var t of r("createArrayFromMixed")(n)){u.has(t)||m(t,a.callbacks);var i=u.get(t);if(i){a.loop&&i.setAttribute("loop",""),a.volume&&(i.volume=a.volume);var l=i.play();l!=null&&typeof l.then=="function"?l.then(function(){(e||(e=o("ODS"))).bumpEntityKey(2966,"sound_player","play.success")}).catch(function(t){(e||(e=o("ODS"))).bumpEntityKey(2966,"sound_player","play.error")}):(e||(e=o("ODS"))).bumpEntityKey(2966,"sound_player","non_promise");return}}},_=function(t){for(var e of r("createArrayFromMixed")(t)){var n=u.get(e);if(n){n.pause();return}}},f=function(t){for(var e of r("createArrayFromMixed")(t)){var n=u.get(e);n&&(n.pause(),n.removeAttribute("src"),n.src=c(e))}};l.preload=m,l.play=p,l.pause=_,l.stop=f}),98);
__d("SoundSynchronizer",["SoundPlayer","WebStorage","createArrayFromMixed"],(function(t,n,r,o,a,i){var e,l="fb_sounds_playing3";function s(){var t=(e||(e=n("WebStorage"))).getLocalStorage();if(t)try{var r=t[l];if(r&&(r=JSON.parse(r),Array.isArray(r)))return r}catch(e){}return[]}function u(t){var r=(e||(e=n("WebStorage"))).getLocalStorage();if(r){var o=s();for(o.push(t);o.length>5;)o.shift();try{r[l]=JSON.stringify(o)}catch(e){}}}function c(e){return s().some(function(t){return t===e})}var d={play:function(t,r,o,a){t=n("createArrayFromMixed")(t),r=r||t[0]+Math.floor(Date.now()/1e3),!c(r)&&(n("SoundPlayer").play(t,{loop:!!o,callbacks:a}),u(r))},isSupported:function(){return!!(e||(e=n("WebStorage"))).getLocalStorage()}};a.exports=d}),null);
__d("SoundRPC",["FBJSON","SecurePostMessage","SoundSynchronizer","cr:950105"],(function(t,n,r,o,a,i,l){function e(e,t,n,r){o("SoundSynchronizer").play(e,t,n,r)}function s(e,t,n,r){var a={name:"SoundRPC",data:{paths:t,sync:n,loop:r}};o("SecurePostMessage").sendMessageAllowAnyOrigin_UNSAFE(e,o("FBJSON").stringify(a))}function u(){return!!window.postMessage}function c(){var t=function(n){if(/\.facebook.com$/.test(n.origin)){var t={};try{var r=n.data;typeof r=="string"&&(t=o("FBJSON").parse(r))}catch(e){}var a=t,i=a.name,l=a.data;i==="SoundRPC"&&l!=null&&typeof l=="object"&&e(l.paths,l.sync,l.loop)}};n("cr:950105")!=null?n("cr:950105").listen(window,"message",t):window.addEventListener("message",t)}l.playLocal=e,l.playRemote=s,l.supportsRPC=u,l._listen=c}),98);
__d("Sound",["SoundInitialData","SoundPlayer","SoundRPC","SoundSynchronizer","URI","UserAgent_DEPRECATED","Visibility","isFacebookURI"],(function(t,n,r,o,a,i,l){var e,s=null,u=!1;function c(e){}function d(e,t,n,r){s?o("SoundRPC").playRemote(s.contentWindow,e,t,!1):o("SoundRPC").playLocal(e,t,n,r),u=!0}function m(){return u}function p(e,t,n){!u&&r("Visibility").isHidden()||d(e,t,n)}function _(e){s||o("SoundPlayer").stop(e)}var f=new(e||(e=r("URI")))(location.href),g=new Set(["comet","www","business"]);f.getSubdomain()&&!g.has(f.getSubdomain())&&f.setSubdomain("www");var h=f.getDomain();function y(){return o("UserAgent_DEPRECATED").ie()<9||r("SoundInitialData").RPC_DISABLED?!1:o("SoundSynchronizer").isSupported()&&o("SoundRPC").supportsRPC()}r("isFacebookURI")(f)&&location.host!==h&&y()&&(s=document.createElement("iframe"),s.setAttribute("src","//"+h+"/sound_iframe.php"),s.style.display="none",document.body&&document.body.appendChild(s)),l.init=c,l.play=d,l.hasPlayedSoundBefore=m,l.playOnlyIfImmediate=p,l.stop=_}),98);
__d("ZenonMachineToQPLEvent",["qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s={ConnectionStateMachine:(e=r("qpl"))._(64243854,"2452"),ParentSignalingClient:e._(64234815,"1094"),PeerConnectionStateMachine:e._(64239068,"6172"),SignalingStateMachine:e._(64245348,"8823")};l.default=s}),98);
__d("ZenonDebugLogger",["ChannelClientID","CurrentUser","FBLogger","IGDWebUtils","Log","LogHistory","ODS","QuickLogActionType","QuickPerformanceLogger","RpWebStateMachineLoggingBlocklist.experimental","UserAgentData","WebDriverConfig","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonLoggingUtils","ZenonMachineToQPLEvent","ZenonODSLogger","formatDate","isEmployeeTestUserZenonLogging"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=null,c=(function(){function t(){var e;this.$1=o("LogHistory").getInstance("webrtc"),this.$2=o("ChannelClientID").getID(),this.$3=JSON.stringify({browser:(e=r("UserAgentData")).browserName,browser_version:e.browserFullVersion,device:e.deviceName,msg_source:"web",os:e.platformName,os_version:e.platformFullVersion,version:2});var t=r("CurrentUser").getAppID();t!=null&&o("IGDWebUtils").isInstagramWebSupportedApp(Number(t))?this.$4=parseInt(t,10):this.$4=0xc815778a650a,this.$5=new Set(r("RpWebStateMachineLoggingBlocklist.experimental").EVENT_TYPES),this.$6=new Set(r("RpWebStateMachineLoggingBlocklist.experimental").STATES)}t.getInstance=function(){return u||(u=new t),u},t.getFBLogger=function(t){var e,n;return t===void 0&&(t={}),r("FBLogger")("rpweb").addMetadata("RT_WEB","CALL_ID",""+((e=t.signalingID)!=null?e:"null")).addMetadata("RT_WEB","PEER_ID",""+((n=t.peerID)!=null?n:"null"))};var n=t.prototype;return n.$7=function(t,n,a){n===void 0&&(n=!0);var e=r("formatDate")(new Date,"[H:i:s:X]",{skipPatternLocalization:!0});r("WebDriverConfig").isJestE2ETestRun&&o("Log").debug(t),this.$1.log("Console",e+" "+t),n&&r("ZenonInfraActionsLogger").logCheckpoint({auditId:r("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] "+t,messageID:a})},n.$8=function(t,n,o){var e=r("formatDate")(new Date,"[H:i:s:X]",{skipPatternLocalization:!0});this.$1.log("Console",e+" "+t+". StateMachineID:  "+(n!=null?n:""));var a={auditId:r("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"[ZP] "+t+".",stateMachineID:n};o!=null&&(a.messageID=o),r("ZenonInfraActionsLogger").logCheckpoint(a)},n.$9=function(t,n,a,i){i===void 0&&(i=0);var e=r("ZenonMachineToQPLEvent")==null?void 0:r("ZenonMachineToQPLEvent")[t];e&&(s||(s=r("QuickPerformanceLogger")))&&r("QuickLogActionType")&&o("ZenonLoggingUtils").shouldAllowLogging()&&(a==="terminated"?(s||(s=r("QuickPerformanceLogger"))).markerEnd(e,2,i):(s||(s=r("QuickPerformanceLogger"))).markerPoint(e,n,{data:{string:{data:a}},instanceKey:i}))},n.$10=function(t){return isNaN(+t)?0:+t},n.getLogHistory=function(){return this.$1},n.logStateMachine=function(t,n,o,a,i){if(r("isEmployeeTestUserZenonLogging")()&&!this.$5.has(o)){var e="["+t+"] [Current State: "+n+"] Processing event: "+o,l={auditId:r("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:""+e,stateMachineID:a};i!=null&&(l.messageID=i),r("ZenonInfraActionsLogger").logCheckpoint(l),this.$9(t,o,n,this.$10(a))}},n.logStateMachineTransition=function(t,n,o,a,i,l,s,u){if(!(this.$6.has(o)||this.$5.has(i))&&r("isEmployeeTestUserZenonLogging")()){var e="";l!=null&&l.length===1&&l[0].type==="defer"?e="["+t+"] [[DEFERRED] "+i+" did not trigger transition. Current state remains "+o:o!==a?e="["+t+"] [[PROCESSED] "+i+" caused transition from "+(a||"")+" to "+o+".":n?e="["+t+"] [[PROCESSED] "+i+" did not trigger transition. Current state remains "+o:(e="["+t+"] [[DROPPED] "+i+" did not trigger transition. Current state remains "+o,this.$11(t)),this.$8(e,s,u)}},n.startQPL=function(t,n){n===void 0&&(n=0),(s||(s=r("QuickPerformanceLogger")))&&o("ZenonLoggingUtils").shouldAllowLogging()&&(s||(s=r("QuickPerformanceLogger"))).markerStart(t,this.$10(n))},n.endQPL=function(t,n){n===void 0&&(n=0),(s||(s=r("QuickPerformanceLogger")))&&r("QuickLogActionType")&&o("ZenonLoggingUtils").shouldAllowLogging()&&(s||(s=r("QuickPerformanceLogger"))).markerEnd(t,2,this.$10(n))},n.logConsole=function(t){this.$7(t,!1)},n.logMQTTStateChange=function(t){var e="mqtt_client_state_"+t;r("ZenonODSLogger").logCounter(e),r("isEmployeeTestUserZenonLogging")()&&r("ZenonInfraActionsLogger").logCheckpoint({auditId:r("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] onMQTTStateChanged: "+t+", document.visibility: "+document.visibilityState+", document.hasFocus: "+String(document.hasFocus())+", navigator.onLine: "+String(navigator.onLine)})},n.logMQTTConnectStats=function(t,n){r("ZenonInfraActionsLogger").logCheckpoint({auditId:r("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] MQTT Connection time: "+String(t)+"ms, Retry Count: "+String(n)})},n.$11=function(n){(e||(e=o("ODS"))).bumpEntityKey(4083,"zenon_state_machine",n+"_event_dropped"),e.flush()},t})();l.default=c}),98);
__d("ZenonDeviceId",["ChannelClientID","WebStorage"],(function(t,n,r,o,a,i,l){"use strict";var e,s="chatd-deviceid";function u(){return o("ChannelClientID").getID()}function c(t){(e||(e=r("WebStorage"))).setAllowlistedKeyToLocalStorage(e.getLocalStorage(),s,t)}function d(){return(e||(e=r("WebStorage"))).getAllowlistedKeyFromLocalStorage(s)}function m(){var e;return(e=d())!=null?e:u()}l.getZenonDeviceId=u,l.setZenonLocalStorageDeviceId=c,l.getZenonLocalStorageDeviceId=d,l.getZenonLocalStorageDeviceIdWithFallback=m}),98);
__d("ZenonSDESKeyDetector",[],(function(t,n,r,o,a,i){"use strict";var e=/inline:\s*[0-9a-zA-z+/]{40}(\b|\s|$)/;function l(t){return e.test(JSON.stringify(t))}i.default=l}),66);
__d("ZenonUserActionLogger",["FBLogger","RtcWebUserActionsDebugFalcoEvent","RtcWebUserActionsFalcoEvent","ZenonDebugLogger","ZenonLoggingUtils","ZenonSDESKeyDetector"],(function(t,n,r,o,a,i,l){"use strict";var e=new Map,s=window.location.hostname.search("facebook")!==-1?"facebook":window.location.hostname.search("messenger")!==-1?"messenger_dot_com":null,u={logCheckpoint:function(t){u.logEvent(babelHelpers.extends({},t,{event:"checkpoint"}))},logClick:function(t){u.logEvent(babelHelpers.extends({},t,{event:"tap"}))},logError:function(t){u.logEvent(babelHelpers.extends({},t,{event:"error"}))},logEvent:function(t){var e,n;if(r("ZenonSDESKeyDetector")(t))throw r("FBLogger")("rtc_www").mustfixThrow("ZenonUserActionLogger event contains SDES crypto key! This log entry must be removed!");if(o("ZenonLoggingUtils").shouldAllowLogging()){var a=babelHelpers.extends({},t,{page:(e=t.page)!=null?e:s}),i=babelHelpers.extends({},a,{client_time:Date.now().toString()});r("RtcWebUserActionsDebugFalcoEvent").log(function(){return i}),r("RtcWebUserActionsFalcoEvent").log(function(){return i}),r("ZenonDebugLogger").getInstance().getLogHistory().log((n=t.event)!=null?n:"null",JSON.stringify(a))}},logImpression:function(t){u.logEvent(babelHelpers.extends({},t,{event:"impression"}))},logPreCallClick:function(t){u.logEvent(babelHelpers.extends({},t,{event:"tap"}))},logPreCallImpression:function(t){u.logEvent(babelHelpers.extends({},t,{event:"impression"}))},startTimer:function(n){var t=Date.now();e=e.set(n,t),u.logCheckpoint({checkpoint:n+"_timerStart"})},stopTimer:function(n){var t=n.checkpointName===void 0?n.timerName:n.checkpointName,r=n.event||{},o=function(n){var t=e.get(n);return t!=null?(e.delete(n),parseInt(Date.now()-t,10)):null},a=o(n.timerName);return u.logCheckpoint(babelHelpers.extends({},r,{checkpoint:t+"_timerEnd",event_time_elapsed:a==null?void 0:a.toString()})),parseInt(a,10)}};i.exports=u}),34);